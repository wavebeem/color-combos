<!DOCTYPE html>
<html lang="en" class="bit-root bit-scrollbar sans-serif overflow-y-scroll">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/1bit-ui@0.15.0/dist/1bit-ui.css"
    />
    <link
      rel="stylesheet"
      href="https://unpkg.com/tachyons@4.12.0/css/tachyons.min.css"
    />
    <script
      defer
      src="https://unpkg.com/tinycolor2@1.4.2/tinycolor.js"
    ></script>
    <style>
      body {
        display: grid;
      }

      @media (min-width: 1024px) {
        body {
          grid-template-columns: max-content 1fr;
        }
      }

      .bit-auto,
      .bit-root {
        --bit-color0: #333;
        --bit-color1: #fafafa;
      }

      @media (prefers-color-scheme: dark) {
        .bit-auto,
        .bit-root {
          --bit-color0: #ccc;
          --bit-color1: #222;
        }
      }

      .sticky {
        position: sticky;
      }

      .top-0 {
        top: 0;
      }

      .resize-v {
        resize: vertical;
      }
    </style>
    <script type="module">
      function $(selector, root = document) {
        return root.querySelector(selector);
      }

      const state = { fg: "", bg: "" };

      function update() {
        resize($("#fg"));
        resize($("#bg"));
        const fgs = $("#fg").value;
        const bgs = $("#bg").value;
        const container = $("#preview-container");
        container.innerHTML = "";
        for (const { fg, bg } of getCombinations({ fgs, bgs })) {
          const contrast = tinycolor.readability(fg, bg);
          const template = $("#preview-template");
          const frag = template.content.cloneNode(true);
          const node = document.createElement("div");
          node.appendChild(frag);
          node.style.setProperty("color", fg);
          node.style.setProperty("background", bg);
          $("[data-name=fg]", node).textContent = fg;
          $("[data-name=bg]", node).textContent = bg;
          $("[data-name=contrast]", node).textContent = contrast.toFixed(1);
          container.appendChild(node);
        }
      }

      function split(str) {
        return str
          .trim()
          .split(/\n+/)
          .filter((x) => x);
      }

      function* getCombinations({ fgs, bgs }) {
        for (const bg of split(bgs)) {
          for (const fg of split(fgs)) {
            yield { fg, bg };
          }
        }
      }

      function resize(textarea) {
        const value = textarea.value.split(/\n/).length;
        const rows = Math.max(4, value + 1);
        textarea.rows = rows;
      }

      $("#fg").addEventListener("input", update);
      $("#bg").addEventListener("input", update);
      update();
    </script>
    <title>CSS Color Contrast Checker</title>
  </head>
  <body class="center min-vh-100 lh-copy">
    <main class="flex-auto pa3 self-start sticky top-0">
      <h1 class="lh-title mt3 mb0">CSS Color Contrast Checker</h1>
      <p class="mt1">
        &copy; 2021
        <a href="https://www.wavebeem.com" class="bit-link">Brian Mock</a>
      </p>
      <p>
        Type CSS color values and see all their combinations and color contrast
        values.
      </p>
      <label class="mb3 db">
        <div class="pb1">Foreground colors (one per line)</div>
        <textarea
          class="bit-input w-100 resize-v code"
          type="text"
          id="fg"
        ></textarea>
      </label>
      <label class="mb3 db">
        <div class="pb1">Background colors (one per line)</div>
        <textarea
          class="bit-input w-100 resize-v code"
          type="text"
          id="bg"
        ></textarea>
      </label>
      <table class="bit-table w-100">
        <thead>
          <tr>
            <th>WCAG Level</th>
            <th>AA</th>
            <th>AAA</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th>Text</th>
            <td>4.5</td>
            <td>7</td>
          </tr>
          <tr>
            <th>Borders</th>
            <td>3</td>
            <td>4.5</td>
          </tr>
          <tr>
            <th>Large text</th>
            <td>3</td>
            <td>4.5</td>
          </tr>
        </tbody>
      </table>
    </main>
    <aside class="pt3">
      <h2 class="lh-title mv3">Preview</h2>
      <div id="preview-container"></div>
    </aside>
    <template id="preview-template">
      <div class="flex flex-column pa3">
        <h3><span data-name="contrast"></span> contrast</h3>
        <p>
          In visual perception a color is almost never seen as it really is â€“ as
          it physically is. This fact makes color the most relative medium in
          art. - Josef Albers
        </p>
        <div role="presentation" class="bt mb3"></div>
        <pre class="ma0">fg: <span data-name="fg"></span></pre>
        <pre class="ma0">bg: <span data-name="bg"></span></pre>
      </div>
    </template>
  </body>
</html>
